:root{
  --bg: #0a0b0c;
  --bg-2:#101214;
  --steel:#8b8f98;
  --steel-hi:#b6bac2;
  --carbon:#1b1d21;
  --accent:#38bdf8;
  --accent-2:#7dd3fc;
  --good:#22c55e;
  --warn:#f59e0b;
  --danger:#ef4444;
  --grid:#272a30;
  --tile:#3a3f47;
  --tile-hi:#5a636f;
  /* largeur plateau desktop (canvas 300 + padding 20 + bordures) */
  --board-w: 322px;
  /* largeur plateau mobile XS (canvas 180 + padding/bordures ≈ 22) */
  --board-w-xs: 202px;
  /* écart horizontal entre les deux plateaux (doit matcher la gap .boards) */
  --board-gap: 26px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: radial-gradient(1200px 800px at 20% 20%, #121418, transparent 60%),
              radial-gradient(1000px 800px at 80% 30%, #0f1115, transparent 55%),
              var(--bg);
  color:#e5e7eb;
}
/* Verrouillage temporaire du scroll durant le calcul initial (évite flash scrollbars) */
html.init-lock, body.init-lock{ overflow:hidden !important }
#app{max-width:1080px;margin:0 auto;min-height:100vh;padding:12px 16px;}
/* Éviter tout scroll horizontal accidentel sur l’écran de jeu */
body.game-open{overflow-x:hidden}
.screen.active#app{display:flex;flex-direction:column}
.screen{display:none}
.screen.active{display:block}
.title{font-family:Orbitron,system-ui;font-weight:700;letter-spacing:.18em;margin:0;color:var(--steel-hi);text-shadow:0 2px 12px rgba(0,0,0,.6)}
.start-tip{opacity:.9;color:#c8cfda}
/* Hero animé */
.hero{position:relative; height: clamp(520px, 72vh, 820px); min-height:520px; max-height:820px; border:1px solid #20242c; border-radius:16px; overflow:hidden; box-shadow:inset 0 1px 0 rgba(255,255,255,.04), 0 30px 80px rgba(0,0,0,.35);}
.hero-bg{position:absolute; inset:0; width:100%; height:100%; display:block; background:url('https://images.unsplash.com/photo-1517816743773-6e0fd518b4a6?q=80&w=1920&auto=format&fit=crop') center/cover no-repeat; filter: saturate(0.9) brightness(0.55) contrast(1.05); z-index:1; transform: translate3d(calc(var(--px,50) * -0.2px), calc(var(--py,50) * -0.2px), 0); pointer-events:none}
.hero-veil{position:absolute; inset:0; pointer-events:none; background:radial-gradient(1000px 600px at 20% 10%, rgba(56,189,248,.08), transparent 60%), linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.55)); z-index:2}
.hero-fx{position:absolute; inset:0; width:100%; height:100%; display:block; pointer-events:none; z-index:3}
.hero-content{position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px; padding:20px; text-align:center; transform: perspective(800px) rotateX(calc((var(--py,50) - 50)*0.08deg)) rotateY(calc((var(--px,50) - 50)*-0.08deg)); transition: transform .08s ease; pointer-events:auto; z-index:5}
.hero .title{font-size: clamp(36px, 6vw, 64px); margin-bottom:6px}
.logo-wrap{position:relative; width:min(80vw, 720px); display:flex; align-items:center; justify-content:center}
.hero-content .logo-wrap{margin-bottom: clamp(12px, 3vh, 28px)}
.logo-wrap::before{content:""; position:absolute; top:12%; bottom:12%; left:-40%; width:26%; background:linear-gradient(75deg, transparent, rgba(255,255,255,.28), transparent); filter:blur(8px); transform:skewX(-15deg); opacity:.35; animation: glint 5.6s linear infinite}
.logo-wrap:hover::before{animation-duration:3.2s}
.logo-img{position:relative; z-index:1}
.logo, .logo-img{width:100%; height:auto}
  .logo, .logo-img{width:auto; max-width:90%; height:auto}
.logo{filter:url(#glow)}
  .logo-img{filter: drop-shadow(0 10px 50px rgba(0,0,0,.5)); animation: float 6s ease-in-out infinite; max-height: clamp(140px, 28vh, 360px);}
.logo-wrap::after{content:""; position:absolute; inset:auto 10% 8% 10%; height:14px; border-radius:999px; background:radial-gradient(ellipse at center, rgba(56,189,248,.18), transparent 60%); filter: blur(10px); opacity:.6; animation: halo 3.6s ease-in-out infinite}
.logo.hidden{display:none}
.logo-fill{fill:url(#g); font: 700 120px Orbitron, system-ui; letter-spacing:.18em}
.logo-stroke{fill:none; stroke:#a3b9c9; stroke-width:10; opacity:.22}
.subtitle{margin:0 0 8px 0; color:#c8cfda}
/* Panneau de présentation (différent des stats) */
.hero-desc{display:flex; align-items:flex-start; gap:8px; margin:4px 0 6px; padding:10px 12px; border-radius:12px; color:#d6dbea; text-align:left;
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.015));
  border: 1px solid #2a2f37;
  box-shadow: inset 0 0 24px rgba(0,0,0,.25);
  max-width:min(920px, 92vw);
}
.hero-desc .hd-ico{color:#a5f3fc; filter: drop-shadow(0 0 8px rgba(56,189,248,.35)); margin-top:1px}
.hero-desc .subtitle{margin:0; color:#cfe7ff}
@media (max-width: 900px){
  .hero-desc{padding:8px 10px; gap:8px; max-width:88vw}
  .hero-desc .subtitle{font-size:14px}
}
@media (max-width: 420px){
  .hero-desc{padding:6px 8px; gap:6px}
  .hero-desc .hd-ico svg{width:16px; height:16px}
  .hero-desc .subtitle{font-size:13px}
}
.hero-actions{display:flex; gap:14px; justify-content:center; margin:8px 0 6px; flex-wrap:wrap}
.hero-content{padding-bottom: clamp(16px, 6vh, 48px)}
.btn.lg{padding:12px 18px; font-size:15px; border-radius:12px}
.btn.primary{background:linear-gradient(180deg,#0b6b9e,#0a4e74); border:1px solid #0c82c1; color:#eaf6ff}
.btn.ghost{background:linear-gradient(180deg,#1e232b,#12151a); border:1px dashed #2a2f37; color:#cdd3dd}
.hero-footer{position:absolute; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center; gap:10px; padding:10px; color:#b2bcc9; font-size:12px; letter-spacing:.06em; background:linear-gradient(180deg, transparent, rgba(0,0,0,.55)); border-top:1px solid rgba(255,255,255,.06); z-index:6; text-shadow:0 1px 8px rgba(0,0,0,.6)}
.hero-footer .hf-line{opacity:.9}
.hero-footer .hf-sep{opacity:.6}
.hero-footer .hf-dot{width:6px; height:6px; border-radius:999px; background:radial-gradient(circle, var(--accent-2), var(--accent)); filter: drop-shadow(0 0 8px rgba(56,189,248,.5))}
.hero-footer .hf-credits{opacity:.95; color:#d4dde8}
/* Particules blocs (dessinées via canvas, mais gardons quelques classes utilitaires) */
.hero .block{position:absolute; width:24px; height:24px; border-radius:6px; background:#3a3f47; box-shadow:0 0 12px rgba(56,189,248,.15)}
.hero-stats{margin-top:8px; margin-bottom:72px; padding:8px; border-radius:14px; background:linear-gradient(180deg, rgba(56,189,248,.08), rgba(255,255,255,.02)); border:1px solid #1e2732; box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 10px 40px rgba(0,0,0,.4)}
.hs-grid{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px}
.hs-item{padding:8px; border-radius:12px; background:linear-gradient(180deg,#0e1318,#0b0f14); border:1px solid #233041; box-shadow: inset 0 0 24px rgba(56,189,248,.08)}
.hs-top{display:flex; align-items:center; gap:6px}
.hs-ico{color:#7dd3fc; filter: drop-shadow(0 0 10px rgba(56,189,248,.35))}
.hs-lab{opacity:.9; color:#cfe7ff; font-size:13px}
.hs-val{margin-left:auto; color:#eaffff; font-size:14px}
.hs-bar{position:relative; height:6px; border-radius:999px; background:linear-gradient(90deg, rgba(56,189,248,.15), rgba(56,189,248,.03)); border:1px solid rgba(56,189,248,.2); margin-top:8px; overflow:hidden}
.hs-bar>span{position:absolute; left:0; top:0; bottom:0; width:0%; background:linear-gradient(90deg, #7dd3fc, #38bdf8); box-shadow:0 0 12px rgba(56,189,248,.45); transition:width .4s ease}
/* Toujours sur une seule ligne, même en mobile (compressé) */
@media (max-width: 900px){ .hs-grid{grid-template-columns: repeat(3, minmax(0,1fr))} }
@media (max-width: 420px){ .hs-lab{font-size:12px} .hs-val{font-size:13px} }

/* Footer héro collé en bas d’écran */
#screen-start .hero .hero-footer{position:fixed; left:0; right:0; bottom:0; border-top:1px solid rgba(255,255,255,.06); background:linear-gradient(180deg, transparent, rgba(0,0,0,.55)); z-index:50}
.join-wrap{max-width:980px;margin:40px auto;padding:16px;border:1px solid #20242c;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.015))}
.join-controls{display:none}
.join-layout{display:grid;grid-template-columns: 1fr; gap:16px}
.join-main{min-height:320px}
.join-panel{border:1px solid #20242c;border-radius:14px;overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.012))}
.join-panel-header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #20242c;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02))}
.join-panel-header .join-actions{display:flex;gap:8px;align-items:center}
.join-panel-header .join-tabs{display:flex;gap:8px;align-items:center}
.join-panel-header .join-tabs .tab{border-radius:999px;padding:6px 10px}
.join-panel-header .btn.primary{padding:8px 12px}
.join-panel-header h3{margin:0;font:600 15px Orbitron,system-ui;color:#e5e7eb;letter-spacing:.06em}
.join-panel-body{padding:10px}
.join-side{display:none}
.tabs{display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap}
.tabs.tabs-compact{gap:6px}
.tabs.tabs-compact.single{justify-content:flex-end}
.tabs.tabs-compact.single .btn{padding:10px 14px; font-weight:600}
.tab{background:linear-gradient(180deg,#1e232b,#12151a);border:1px solid #2a2f37;color:#cdd3dd;border-radius:999px;padding:6px 10px;cursor:pointer;font-size:12px;transition:.15s ease;line-height:1}
.tab.active{border-color:#3a404b;color:#fff;box-shadow:0 0 0 2px rgba(56,189,248,.15)}
.rooms-summary{margin:0;padding:8px 10px;border:1px dashed #2a2f37;border-radius:8px;background:rgba(255,255,255,.02);color:#c8cfda}
.join-summary-band{margin-top:12px}
.join-summary-band{display:flex; justify-content:center}
.rooms-summary{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02)); border:1px solid #20242c; border-radius:12px; padding:10px 12px; box-shadow:inset 0 1px 0 rgba(255,255,255,.06), 0 8px 30px rgba(0,0,0,.35)}
.rooms-summary .rs-list{display:flex; align-items:center; gap:10px; list-style:none; margin:0; padding:0}
.rooms-summary .rs-item{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:linear-gradient(180deg, rgba(56,189,248,.10), rgba(56,189,248,.02)); border:1px solid rgba(56,189,248,.25)}
.rooms-summary .rs-item .rs-ico{color:#7dd3fc; filter: drop-shadow(0 0 8px rgba(56,189,248,.35))}
.rooms-summary .rs-item .rs-lab{opacity:.9; color:#cfe7ff}
.rooms-summary .rs-item .rs-val{color:#eaffff}
.rooms-summary .rs-sep{opacity:.5; padding:0 2px}
.rooms{list-style:none;margin:0;padding:0;max-height:420px;overflow:auto; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px}
.rooms li{display:flex;justify-content:space-between;align-items:center;gap:8px;padding:12px;border:1px solid #2a2f37;border-radius:12px;margin:0;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.01))}
.players{list-style:none;margin:0;padding:0;max-height:420px;overflow:auto;display:none}
.players li{display:flex;justify-content:space-between;align-items:center;gap:8px;padding:12px;border:1px solid #2a2f37;border-radius:12px;margin-bottom:10px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.01))}
.empty-state{padding:24px;border:1px dashed #2a2f37;border-radius:12px;text-align:center;color:#aeb6c3;background:rgba(255,255,255,.02)}
.empty-state.hidden{display:none}
.badge.status{border-color:#344054;background:rgba(56,189,248,.08);color:#7dd3fc}
.badge.danger{border-color:#7f1d1d;background:rgba(239,68,68,.12);color:#fecaca}
.badge.good{border-color:#115e2e;background:rgba(16,185,129,.12);color:#86efac}
.bottombar{display:none}
.topbar{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:14px}
.topbar .controls{display:flex; align-items:center; gap:8px}
.topbar .btn, .topbar .toggle{height:32px; padding:6px 10px; display:inline-flex; align-items:center; gap:6px}
.topbar .btn .ico, .topbar .toggle .ico{width:18px; height:18px}
.topbar .btn.toggle.active{background:linear-gradient(180deg,#0b6b9e,#0a4e74); border:1px solid #0c82c1; color:#eaf6ff; box-shadow:0 0 0 2px rgba(56,189,248,.18)}
/* Chevron dans le bouton Easy */
.topbar .btn .caret{margin-left:2px; width:12px; height:12px; opacity:.85; transition: transform .12s ease, opacity .12s ease; transform: translateY(1px)}
.topbar .btn[aria-expanded="true"] .caret{transform: rotate(180deg) translateY(-1px); opacity:1}
/* Couleurs par profil IA (du doux → agressif) */
/* Prudent: vert froid/gris (encore plus soft) */
#easy-btn.easy-prudent{background:linear-gradient(180deg,#0f5a4a,#0b3e35); border-color:#0f6b58; color:#eafff7; box-shadow:0 0 0 2px rgba(34,197,94,.16)}
#easy-btn.easy-prudent:hover{box-shadow:0 0 0 2px rgba(34,197,94,.22)}
/* Conservateur: vert/teal doux */
#easy-btn.easy-conservateur{background:linear-gradient(180deg,#136a5a,#0e4c41); border-color:#147a66; color:#eafff7; box-shadow:0 0 0 2px rgba(16,185,129,.18)}
#easy-btn.easy-conservateur:hover{box-shadow:0 0 0 2px rgba(16,185,129,.24)}
/* Équilibré: bleu (par défaut actif) */
#easy-btn.easy-equilibre{background:linear-gradient(180deg,#0b6b9e,#0a4e74); border-color:#0c82c1; color:#eaf6ff; box-shadow:0 0 0 2px rgba(56,189,248,.18)}
/* Agressif: ambre/orange vif */
#easy-btn.easy-agressif{background:linear-gradient(180deg,#f59e0b,#b45309); border-color:#92400e; color:#fff; box-shadow:0 0 0 2px rgba(245,158,11,.22)}
#easy-btn.easy-agressif:hover{box-shadow:0 0 0 2px rgba(245,158,11,.28)}
/* Dropdown IA custom */
.ai-dd{position:absolute; z-index:1000; margin-top:0; padding:6px; border:1px solid #242933; border-radius:12px; background:linear-gradient(180deg,#0f1318,#0b0e12); box-shadow:0 20px 80px rgba(0,0,0,.55)}
.topbar{position:relative}
.topbar #easy-btn{position:relative; z-index:1001}
/* Coller le menu au bouton : apparence d'un seul bloc */
.topbar #easy-btn[aria-expanded="true"]{ border-bottom-left-radius:6px; border-bottom-right-radius:6px }
.topbar #easy-btn[aria-expanded="true"] + .ai-dd{ 
  margin-top:-4px; /* chevauche légèrement le bas du bouton */
  border-top-left-radius:8px; border-top-right-radius:8px; 
  /* Liseré fusion */
  box-shadow:0 20px 80px rgba(0,0,0,.55), 0 -2px 0 rgba(12,130,193,.12) inset;
}
.ai-dd{ 
  /* aligner horizontalement sur le bouton par JS; ici on supprime l’écart visuel */
  transform: translateY(0);
}
.ai-dd.hidden{display:none}
.topbar{position:relative}
.ai-dd .ai-opt{display:flex; align-items:center; gap:8px; width:100%; text-align:left; padding:10px 12px; border:1px solid transparent; border-radius:10px; background:transparent; color:#e5e7eb; cursor:pointer}
.ai-dd .ai-opt .ai-ico{width:18px; display:inline-flex; justify-content:center}
.ai-dd .ai-opt .ai-lab{flex:1}
.ai-dd .ai-opt[aria-checked="true"]{background:linear-gradient(180deg,#1e232b,#151920); border-color:#2a2f37; box-shadow:inset 0 0 0 1px rgba(56,189,248,.12)}
.ai-dd .ai-opt:hover,
.ai-dd .ai-opt:focus-visible{border-color:#3a9bd9; color:#fff; background:linear-gradient(180deg, rgba(14,165,233,.18), rgba(14,165,233,.08)); box-shadow:0 0 0 3px rgba(56,189,248,.16)}
/* Mobile: augmenter la cible tactile */
@media (max-width: 900px){ .ai-dd .ai-opt{padding:12px 14px; gap:10px} .ai-dd{border-radius:14px} }
.bottombar .credits{opacity:.95; color:#e2e8f0; font-size:12px; text-shadow:0 1px 8px rgba(0,0,0,.5)}
.topbar h1{font-family:Orbitron,system-ui;font-weight:700;letter-spacing:.18em;margin:0;color:var(--steel-hi);text-shadow:0 2px 12px rgba(0,0,0,.6)}
.brand{display:flex;align-items:center;gap:10px}
.app-title{font-family:Orbitron,system-ui;font-weight:700;letter-spacing:.16em;color:var(--steel-hi); margin:0; font-size:18px}
.btn{background:linear-gradient(180deg,#1e232b,#12151a);border:1px solid #2a2f37;color:#cdd3dd;border-radius:10px;padding:7px 10px;cursor:pointer}
.btn{transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, color .12s ease}
.btn:hover{border-color:#3a404b;color:#fff;box-shadow:0 0 0 2px rgba(56,189,248,.15); transform: translateY(-1px)}
.btn:active{transform: translateY(0)}
.btn .ico{display:inline-flex; align-items:center; justify-content:center}
.visually-hidden{position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,1px,1px); white-space:nowrap; border:0}
.toggle{display:inline-flex;align-items:center;gap:6px;font-size:12px;opacity:.9}
.toggle input{accent-color:#38bdf8}
.layout{display:grid;grid-template-columns: calc(var(--board-w)*2 + var(--board-gap)) 300px;gap:20px;grid-template-areas:"boards sidebar";align-items:start;flex:1}
.solo-mode .layout{grid-template-columns: var(--board-w) 300px; justify-content:center}
.boards{grid-area:boards;display:grid;grid-template-columns: var(--board-w) var(--board-w);gap:var(--board-gap);justify-content:flex-start;align-items:start; width: calc(var(--board-w)*2 + var(--board-gap))}
.solo-mode .boards{grid-template-columns: var(--board-w); width: var(--board-w); justify-content:center; margin: 0 auto}
.boards > .wait{position:absolute; z-index:5; left:50%; transform:translateX(-50%); top: 14px; margin:0; width:auto; padding:6px 10px; border-radius:10px; border:1px solid #0ea5e9; background: linear-gradient(180deg, rgba(14,165,233,.2), rgba(14,165,233,.08)); color:#eaf6ff; box-shadow:0 8px 40px rgba(14,165,233,.25), 0 0 0 3px rgba(14,165,233,.18); font-size:13px}
.boards{position:relative}
.sidebar{grid-area:sidebar}
.toast{position:fixed; left:50%; top:26px; transform:translateX(-50%); z-index:10000; text-align:center; pointer-events:none}
.toast:not(.hidden){animation: toastfade 0.25s ease-in;}
.toast .msg{display:inline-block; padding:16px 22px; border:1px solid #2a2f37; border-radius:16px; background:radial-gradient(circle at 40% 0%, rgba(56,189,248,.14), rgba(255,255,255,.03)); color:#eaf2ff; box-shadow:0 18px 80px rgba(0,0,0,.6), 0 0 0 3px rgba(56,189,248,.16); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); font-size:17px; letter-spacing:.02em}
@keyframes toastpulse{0%{transform:scale(0.98)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
.toast:not(.hidden) .msg{animation: toastpulse .6s ease}
.board-wrap{display:flex;flex-direction:column;align-items:center;gap:10px}
.frame{position:relative;padding:10px;border-radius:16px;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid #20242c;box-shadow:inset 0 1px 0 rgba(255,255,255,.06), 0 30px 80px rgba(0,0,0,.35); overflow:hidden; contain:paint}
.frame::before{content:""; position:absolute; left:10px; top:10px; right:10px; bottom:10px; border-radius:10px; pointer-events:none; background: linear-gradient(180deg, rgba(56,189,248,.08), rgba(56,189,248,0) 60%); opacity:.0; animation: scan 4.2s linear infinite}
.frame.pop{animation: pop .16s ease}
.frame.shake{animation: shake .6s ease}
canvas{display:block;background:linear-gradient(180deg,var(--carbon),#0f1216);border-radius:10px}
canvas.input-locked{cursor:not-allowed; filter: saturate(0.92) brightness(0.96)}
canvas.fx{position:absolute;left:10px;top:10px;pointer-events:none;mix-blend-mode:screen}
.frame::after{content:""; position:absolute; inset:6px; border-radius:12px; pointer-events:none; box-shadow: inset 0 0 40px rgba(56,189,248,.08), 0 0 0 1px rgba(56,189,248,.06)}
.panel.opp-preview{display:none;flex-direction:column;align-items:center;gap:6px}
.panel.opp-preview canvas{width:110px; height:220px}
.solo-mode #board-opp{display:none !important}
.hint{opacity:.8;font-size:12px}
.hint.small{font-size:11px;opacity:.9}
.hidden{display:none !important}
.sidebar{display:flex;flex-direction:column;gap:16px}
.panel{background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.015));border:1px solid #20242c;border-radius:12px;padding:12px}
.panel h2{font-family:Orbitron,system-ui;font-weight:600;color:var(--steel-hi);font-size:16px;margin:0 0 8px 0}
.sidebar .panel h2{font-size:12px}
/* Unification: mêmes tailles et formats pour tout le texte de la sidebar */
.sidebar .panel, .sidebar .panel *{font-size:12px; line-height:1.22}
/* Même taille pour Niveau/Score/Lignes (libellés et valeurs) */
.status .stat span, .status .stat strong{font-size:13px}
.status .big strong{font-size:13px; color:#fff; text-shadow:0 2px 12px rgba(56,189,248,.12)}
.panel.next .next-wrap canvas{image-rendering: -webkit-optimize-contrast}
.panel.board{background:linear-gradient(180deg, rgba(56,189,248,.04), rgba(255,255,255,.012)); box-shadow:inset 0 0 20px rgba(56,189,248,.06)}
.status .stat{display:flex;align-items:center;justify-content:space-between;margin:6px 0;color:#c8cfda}
/* tailles déjà harmonisées ci-dessus */
/* Pulse score */
@keyframes pulseScore{0%{transform:scale(1); text-shadow:0 0 0 rgba(56,189,248,0)}40%{transform:scale(1.08); text-shadow:0 0 14px rgba(56,189,248,.35)}100%{transform:scale(1); text-shadow:0 0 0 rgba(56,189,248,0)}}
.status .big strong.pulse{animation:pulseScore .35s ease}
.top10{list-style:none;margin:0;padding:0;max-height:280px;overflow:auto}
.top10 li{padding:2px 0;color:#d4d9e2}
.multiplayer .mp-controls{display:flex;gap:8px;margin-bottom:8px}
.multiplayer .rooms{list-style:none;margin:8px 0 0 0;padding:0;max-height:160px;overflow:auto}
.multiplayer .rooms li{display:flex;justify-content:space-between;align-items:center;gap:8px;padding:6px;border:1px solid #2a2f37;border-radius:8px;margin-bottom:6px;background:rgba(255,255,255,.02)}
.multiplayer .rooms button{padding:6px 10px}
.mp-roominfo,.mp-players{display:flex;justify-content:space-between;gap:8px;color:#c8cfda}
.multiplayer .ready{background:#0a3a27;border-color:#116644;color:#b9f6cf}
.players-list{list-style:none;margin:8px 0 0 0;padding:0;display:flex;flex-direction:column;gap:6px}
.players-list li{display:flex;flex-direction:column;align-items:stretch;gap:2px;padding:6px;border:1px solid #2a2f37;border-radius:8px;background:rgba(255,255,255,.02)}
.players-list li .row{display:flex;align-items:center;gap:6px}
.players-list li .row1{justify-content:flex-start}
.players-list li .row2{justify-content:flex-end}
.players-list li .name{display:flex;align-items:center;gap:6px;max-width:100%;min-width:0}
.players-list li .name .st{font-size:12px; line-height:1}
.players-list li .name .nm{font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:100%}
.players-list li .sc{font-variant-numeric: tabular-nums; color:#a8fffb; font-size:11px}
.badge{display:inline-block;margin-left:6px;padding:2px 6px;border-radius:999px;border:1px solid #2a2f37;background:rgba(255,255,255,.04);font-size:11px;color:#c8cfda}
.badge.ready{border-color:#115e2e;background:rgba(16,185,129,.12);color:#86efac}
.badge.wait{opacity:.8}
.wait{margin:0 0 10px;padding:8px 12px;border:1px dashed #2a2f37;border-radius:8px;background:rgba(255,255,255,.02);color:#c8cfda;text-align:center}
.modal{border:none;border-radius:12px;padding:0;background:transparent}
.modal::backdrop{background:rgba(0,0,0,.65)}
.modal-content{background:linear-gradient(180deg,#0f1318,#0b0e12);border:1px solid #242933;border-radius:12px;padding:16px;min-width:280px;color:#d6dbea;box-shadow:0 20px 80px rgba(0,0,0,.55)}
.modal .top10{max-height:55vh; overflow:auto; padding-right:4px}
.modal-content input{width:100%;padding:10px;border-radius:8px;border:1px solid #2a2f37;background:#0d1116;color:#e5e7eb}
.modal-content menu{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}
.modal-content .primary{background:#0b6b9e;border:1px solid #0c82c1;color:#eaf6ff;border-radius:8px;padding:8px 12px}
/* Aide */
.help-body{color:#cfd7e4}
.help-body ul{margin:0 0 8px 18px}
.help-body li{padding:2px 0}
.help-body .small{opacity:.9; font-size:12px}

/* Overlay compte à rebours */
.countdown{position:fixed; inset:0; z-index:1000;}
.countdown.hidden{display:none}
.countdown-box{position:absolute; left:0; top:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center; gap:16px}
.countdown-text{background:rgba(0,0,0,.55); color:#e5e7eb; border:1px solid #2a2f37; border-radius:12px; font: bold 72px Orbitron, system-ui; padding:24px 36px; box-shadow:0 10px 60px rgba(0,0,0,.5)}
.countdown .btn{position:absolute; bottom:24px; right:24px; padding:8px 12px}

/* Tuiles acier/carbone */
.tile{stroke:#000;stroke-opacity:.15}
.tile.g1{fill:#47505B}
.tile.g2{fill:#56606C}
.tile.g3{fill:#677280}
.tile.g4{fill:#798494}
.glow{filter: drop-shadow(0 0 8px rgba(56,189,248,.35)) drop-shadow(0 0 22px rgba(56,189,248,.15));}

/* Effets visuels pour lignes */
.fx-line{position:absolute;left:10px;top:10px}

@media (max-width: 900px){
  .topbar{padding:6px 8px; margin-bottom: 6px}
  .btn{padding:6px 8px; font-size:12px}
  .btn.lg{padding:10px 14px}
  .ai-dd{margin-top:4px}
  .app-title{font-size:16px}
  .toggle{font-size:11px}
  /* Layout mobile: rangée 1 = boards + sidebar, rangée 2 = under (panneaux déplacés) */
  #app .layout{grid-template-columns: 1fr max(108px, 26vw); grid-template-areas: 
    "boards sidebar"
    "under  under";
    gap:8px; margin-top:6px}
  /* Forcer l’assignation des zones pour éviter tout wrapping inattendu */
  #app .boards{grid-area: boards}
  #app .sidebar{grid-area: sidebar}
  #app .under-panels{grid-area: under}
  #app .boards{grid-template-columns: 1fr; width: auto; justify-content:center}
  #app .boards > .wait{top: 6px; font-size:12px; padding:5px 8px}
  #app .boards{margin-top:4px}
  /* Sidebar mobile simple (garde Next + Aperçu) */
  #app .sidebar{display:block}
  /* Conteneur sous le plateau en 2 colonnes */
  #app .under-panels{grid-area: under; display:grid; grid-template-columns: 1fr 1.1fr; gap:8px; align-items:stretch; grid-auto-rows: 1fr; grid-auto-flow: dense}
  /* Empêcher le passage à la ligne: chaque panel occupe sa colonne */
  #app .under-panels > .panel{min-width:0}
  /* Position explicite: statut à gauche, multijoueur à droite */
  #app .under-panels .panel.status{grid-column:1}
  #app .under-panels #panel-mp{grid-column:2}
  #app .under-panels > .panel{height:100%; min-height: 130px; display:flex; flex-direction:column; width:100%}
  /* Serrer les éléments autour du plateau */
  .board-wrap{gap:6px}
  /* Toujours masquer le grand plateau adverse sur mobile */
  #board-opp{display:none !important}
  #board-me{display:flex}
  /* Sidebar compacte en colonne, flux naturel */
  .sidebar{grid-area: sidebar; display:flex; flex-direction:column; gap:8px}
  /* Le panneau multijoueur occupe la ligne mp en dessous des plateaux */
  #panel-mp{margin-top: 0}
  /* éviter tout offset vertical du panneau multi dans under-panels */
  #app .under-panels #panel-mp{margin-top:0}
  .panel{padding:6px}
  .panel h2{font-size:10px}
  /* Sidebar très compacte et uniforme en mobile */
  .sidebar .panel, .sidebar .panel *{font-size:9.5px; line-height:1.2}
  /* Uniformiser Score avec Niveau/Lignes */
  .status .big strong{font-size:9.5px}
  /* Liste multi encore plus compacte */
  .players-list li{padding:5px}
  .players-list li .name .st{font-size:9.5px}
  .players-list li .name .nm{font-size:9.5px}
  .players-list li .sc{font-size:9.5px}
  .panel.next .next-wrap{grid-template-columns:1fr 1fr; gap:6px}
  .panel.next canvas{width:44px; height:44px}
  /* Miniature adversaire visible uniquement en multi */
  #app:not(.solo-mode) .panel.opp-preview{display:flex}
  #app.solo-mode .panel.opp-preview{display:none}
  .panel.opp-preview canvas{width:66px; height:120px}
  /* Fixer la valeur du niveau à 10px */
  .status #level{font-size:10px}
  .hero{height: clamp(460px, 64vh, 680px)}
  .bottombar{flex-wrap:wrap; gap:8px}
  .bottombar .credits{order:3; width:100%; text-align:center}
  /* Modales plus compactes en mobile */
  .modal .modal-content{min-width:240px; max-width:88vw}
  .modal .top10{max-height:52vh}
  .modal.hero-top10 .modal-content{min-width:0; width:88vw}
  /* Grille salons: retour à 1 colonne en mobile */
  .rooms{display:grid; grid-template-columns: 1fr; gap:8px}
  /* Top10 plus compact en mobile */
  .top10.neon{padding-left:14px}
  .top10.neon li{padding:6px 2px}
  .top10.neon li .line{gap:6px}
  .top10.neon li .dots{max-width:50%}
}

/* Palier plus petit: ≤600px */
@media (max-width: 600px){
  #app .layout{grid-template-columns: 1fr max(100px, 26vw); grid-template-areas: "boards sidebar" "under under"; gap:8px; margin-top:8px}
  .panel{padding:6px}
  .panel h2{font-size:9px}
  .sidebar .panel, .sidebar .panel *{font-size:8.5px; line-height:1.15}
  /* Uniformiser Score avec Niveau/Lignes */
  .status .big strong{font-size:8.5px}
  .panel.next canvas{width:40px; height:40px}
  .panel.opp-preview canvas{width:60px; height:110px}
  .status #level{font-size:10px}
  .players-list li{padding:5px}
  .players-list li .name .st{font-size:8.5px}
  .players-list li .name .nm{font-size:8.5px}
  .players-list li .sc{font-size:8.5px}
}

/* Palier très petit: ≤420px */
@media (max-width: 420px){
  #app .layout{grid-template-columns: 1fr max(92px, 25vw); grid-template-areas: "boards sidebar" "under under"; gap:8px; margin-top:8px}
  /* Espacer davantage les panneaux de la sidebar */
  #app .sidebar > .panel{margin-bottom:10px}
  .btn{padding:4px 6px; font-size:10px}
  /* XS: conserver 2 colonnes compactes sous le plateau */
  #app .under-panels{grid-template-columns: 1fr 1.2fr}
  .app-title{font-size:15px}
  .panel h2{font-size:8.5px}
  .sidebar .panel, .sidebar .panel *{font-size:7.8px; line-height:1.12}
  /* Uniformiser Score avec Niveau/Lignes */
  .status .big strong{font-size:7.8px}
  .panel.next canvas{width:34px; height:34px}
  .panel.opp-preview canvas{width:54px; height:100px}
  .status #level{font-size:10px}
  #app .boards > .wait{font-size:11px; padding:4px 6px}
  .players-list li{padding:4px}
  .players-list li .name .st{font-size:7.8px}
  .players-list li .name .nm{font-size:7.8px}
  .players-list li .sc{font-size:7.8px}
}

/* Réduction de mouvements si l’utilisateur préfère moins d’animations */
@media (prefers-reduced-motion: reduce){
  .frame.stress-blink{animation:none}
  .hero-fx, .hero-bg{filter:none}
}

/* Effets de survol explosifs sur les boutons du héro */
.hero-actions .btn{position:relative; overflow:hidden}
.hero-actions .btn::after{content:""; position:absolute; inset:-50%; background:radial-gradient(circle at var(--x,50%) var(--y,50%), rgba(56,189,248,.35), transparent 45%); opacity:0; transition:opacity .2s ease; pointer-events:none; filter:blur(8px)}
.hero-actions .btn:hover::after{opacity:1}

/* Modale Top10 héro dynamique */
.modal.hero-top10 .modal-content{min-width:320px; background:linear-gradient(180deg,#0d1217,#0b0f14); border:1px solid #253040; box-shadow:0 30px 120px rgba(0,0,0,.65), inset 0 1px 0 rgba(255,255,255,.05)}
.modal.hero-top10 .modal-content{max-width:92vw}
@media (max-width: 900px){
  .modal.hero-top10 .modal-content{min-width:0; width:88vw; max-width:88vw}
}
.hero-top10-header{display:flex; align-items:center; justify-content:flex-start; gap:12px; margin-bottom:10px; position:relative; padding-right:56px}
.hero-top10-header h3{margin:0}
.hero-top10-header .tabs{margin-left:8px; margin-right:56px}
/* Bouton croix générique pour fermer une modale (style fenêtre) */
#top10-close-x{position:absolute; top:10px; right:10px; width:30px; height:30px; padding:0; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; font-size:0; color:transparent; background:linear-gradient(180deg,#1e232b,#12151a); border:1px solid #2a2f37; z-index:2}
#top10-close-x::before, #top10-close-x::after{content:""; position:absolute; width:16px; height:2px; background:#ef4444; border-radius:2px; box-shadow:0 0 10px rgba(239,68,68,.45)}
#top10-close-x::before{transform: rotate(45deg)}
#top10-close-x::after{transform: rotate(-45deg)}
#top10-close-x:hover{box-shadow:0 0 0 2px rgba(239,68,68,.28); border-color:#7f1d1d; filter: brightness(1.05)}
/* Bouton fermer type fenêtre (croix) */
#top10-hero-close{position:absolute; top:0px; right:10px; width:30px; height:30px; padding:0; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; font-size:0; color:transparent; background:linear-gradient(180deg,#1e232b,#12151a); border:1px solid #2a2f37; z-index:2}
#top10-hero-close::before, #top10-hero-close::after{content:""; position:absolute; width:16px; height:2px; background:#ef4444; border-radius:2px; box-shadow:0 0 10px rgba(239,68,68,.45)}
#top10-hero-close::before{transform: rotate(45deg)}
#top10-hero-close::after{transform: rotate(-45deg)}
#top10-hero-close:hover{box-shadow:0 0 0 2px rgba(239,68,68,.28); border-color:#7f1d1d; filter: brightness(1.05)}

@media (max-width: 600px){
  .hero-top10-header{padding-right:50px; gap:10px}
  .hero-top10-header .tabs{margin-right:50px}
}

/* Ajouts ciblés (CTA, salons layout, toast centre) */
.btn.sm{padding:6px 10px; font-size:12px; border-radius:999px}
.btn.cta-blink{position:relative; animation: ctablink 1.2s ease-in-out infinite}
@keyframes ctablink{0%{box-shadow:0 0 0 0 rgba(56,189,248,0)}50%{box-shadow:0 0 0 4px rgba(56,189,248,.28)}100%{box-shadow:0 0 0 0 rgba(56,189,248,0)}}
.btn.cta-strong{animation: ctablink 1s ease-in-out infinite}
.rooms li .room-title{display:flex;flex-direction:column;gap:2px;flex:1;min-width:0}
.rooms li .room-title strong{font-size:14px}
.rooms li .room-title small{color:#aeb6c3}
.rooms li .room-right{display:flex;align-items:center;gap:10px;margin-left:auto}
.rooms li .room-right .btn{padding:6px 10px}
.toast.at-center{left:var(--toast-left,50%); top:var(--toast-top,26px); transform:translate(-50%,-50%)}
.hero-top10-body{max-height:60vh; overflow:auto; padding-right:4px}
.top10.neon{padding-left:18px; padding-right:4px}
.top10.neon li{padding:8px 2px; color:#e8eef7; text-shadow:0 0 6px rgba(56,189,248,.2)}
.top10.neon li .line{display:grid; grid-template-columns: auto 1fr auto; align-items:center; gap:6px}
.top10.neon li .nm{font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
.top10.neon li .dots{border-bottom:1px dotted rgba(200,210,222,.35); height:1px; align-self:center; max-width:60%}
.top10.neon li .sc{font-variant-numeric: tabular-nums; color:#a8fffb}
.top10.neon li .sub{opacity:.75; font-size:12px; margin-left:2px}
.top10.neon li.prime .nm{color:#b3e5ff}
.top10.neon li.prime .sc{color:#c7f789}
.top10.neon li.prime{background:linear-gradient(90deg, rgba(56,189,248,.08), transparent); border-radius:8px; padding:10px 8px}

/* Added: next panel grid, danger button, and stress blink animation */
.panel.next .next-wrap{display:grid;grid-template-columns:1fr 1fr;gap:8px;justify-items:center;align-items:center}
.btn.danger{background:linear-gradient(180deg,#ef4444,#b91c1c);border:1px solid #7f1d1d;color:#fff}
/* États du bouton Prêt (MP) */
.btn.ready{background:linear-gradient(180deg,#16a34a,#166534);border:1px solid #14532d;color:#eafff1}
.btn.ready:hover{box-shadow:0 0 0 2px rgba(34,197,94,.22)}
.btn.attn{background:linear-gradient(180deg,#f59e0b,#b45309);border:1px solid #92400e;color:#fff;animation: ctablink 1s ease-in-out infinite}
@keyframes stress-blink{0%{box-shadow:inset 0 1px 0 rgba(255,255,255,.06),0 30px 80px rgba(0,0,0,.35)}50%{box-shadow:inset 0 0 18px rgba(239,68,68,.45),0 0 22px rgba(239,68,68,.25)}100%{box-shadow:inset 0 1px 0 rgba(255,255,255,.06),0 30px 80px rgba(0,0,0,.35)}}
.frame.stress-blink{animation:stress-blink .85s ease-in-out infinite}
@keyframes scan{0%{opacity:.0; transform: translateY(-20%);} 15%{opacity:.6;} 50%{opacity:.25;} 100%{opacity:.0; transform: translateY(80%);}}
@keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
@keyframes shake{0%{transform:translate(0,0) rotate(0)}20%{transform:translate(1px,-1px) rotate(-.2deg)}40%{transform:translate(-2px,1px) rotate(.2deg)}60%{transform:translate(2px,0) rotate(-.1deg)}80%{transform:translate(-1px,2px) rotate(.1deg)}100%{transform:translate(0,0) rotate(0)}}
@keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
@keyframes halo{0%{opacity:.6; transform:scaleX(1)}50%{opacity:.2; transform:scaleX(1.12)}100%{opacity:.6; transform:scaleX(1)}}
@keyframes glint{0%{left:-40%}100%{left:120%}}
